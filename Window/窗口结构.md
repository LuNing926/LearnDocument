 ## Window、PhoneWindow、DecorView
 - 每个Activity都有一个Window，Window是抽象类
 - PhoneWindow是Window的唯一实现类
 - PhoneWindow中持有一个DecorView，所有view的根view
 
 ## Activity.setContentView
 从setContentView追踪window的窗口加载过程
 Activity.java -> getWindow(): PhoneWindow
 ```
 public void setContentView(@LayoutRes int layoutResID) {
        getWindow().setContentView(layoutResID);           //getWindow(): PhoneWindow
        initWindowDecorActionBar();
    }
```
PhoneWindow.java -> installDecor()创建DecorView
```
@Override
public void setContentView(int layoutResID) {
    // Note: FEATURE_CONTENT_TRANSITIONS may be set in the process of installing the window
    // decor, when theme attributes and the like are crystalized. Do not check the feature
    // before this happens.
    if (mContentParent == null) {
        installDecor();                                   // 创建DecorView
    } else if (!hasFeature(FEATURE_CONTENT_TRANSITIONS)) {
        mContentParent.removeAllViews();
    }
 
    if (hasFeature(FEATURE_CONTENT_TRANSITIONS)) {
        final Scene newScene = Scene.getSceneForLayout(mContentParent, layoutResID, getContext());
        transitionTo(newScene);
    } else {
        mLayoutInflater.inflate(layoutResID, mContentParent);       // 上边installDecorView已经将
    }
    mContentParent.requestApplyInsets();
    final Callback cb = getCallback();
    if (cb != null && !isDestroyed()) {
        cb.onContentChanged();                            // Activity中重写，处理content change
    }
    mContentParentExplicitlySet = true;
}
```
installDecorView
```
private void installDecor() {
    mForceDecorInstall = false;
    if (mDecor == null) {
        mDecor = generateDecor(-1);                       // new DecorView, 创建一个空的DecorView
        mDecor.setDescendantFocusability(ViewGroup.FOCUS_AFTER_DESCENDANTS);
        mDecor.setIsRootNamespace(true);
        if (!mInvalidatePanelMenuPosted && mInvalidatePanelMenuFeatures != 0) {
            mDecor.postOnAnimation(mInvalidatePanelMenuRunnable);
        }
     } else {
         mDecor.setWindow(this);
     }
     if (mContentParent == null) {
         mContentParent = generateLayout(mDecor);         // 根据style、feature等设置窗口的属性，根据窗口类型（No actionbar，progress等）确定layout id
    ......
```
 
 - ![笔记](https://github.com/LuNing926/LearnDocument/blob/main/Window/image/window.jpg)
 
